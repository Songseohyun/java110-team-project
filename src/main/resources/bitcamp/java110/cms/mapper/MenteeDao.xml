<?xml version="1.0" encoding="UTF-8"?>

<!-- BigTagDao 클래스가 사용할 SQL이 들어 있는 파일 -->
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="bitcamp.java110.cms.dao.MenteeDao">

   
    <resultMap type="mentee" id="menteeMap">
        <id column="meno"        property="no"/>
        <result column="name"   property="name"/>
        <result column="email"   property="email"/>
        <result column="pwd"   property="pwd"/>
        <result column="nick"   property="nick"/>
        <result column="phone"   property="phone"/>
        <result column="pstno"   property="pstno"/>
        <result column="bas_addr"   property="bas_addr"/>
        <result column="det_addr"   property="det_addr"/>
        <result column="phot"   property="phot"/>
        <result column="sell"   property="sell"/>
        <result column="bkname"   property="bkname"/>
        <result column="bkno"   property="bkno"/>
        <result column="rgdt"   property="rgdt"/>
        <result column="stat"   property="stat"/>
        <result column="note"   property="note"/>
        <result column="mtstat"   property="mtstat"/>
    </resultMap>
    
    <select id="findAll" resultMap="menteeMap">
        select
            meno,
            name,
            email,
            pwd,
            nick,
            phone,
            pstno,
            bas_addr,
            det_addr,
            phot,
            sell,
            bkname,
            bkno,
            rgdt,
            stat,
            note,
            mtstat
        from 
            p_mete
        order by 
            meno asc
    </select>

    <select id="findByNo" 
            resultMap="menteeMap" parameterType="int">
        select
            meno,
            name,
            email,
            pwd,
            nick,
            phone,
            pstno,
            bas_addr,
            det_addr,
            phot,
            sell,
            bkname,
            bkno,
            rgdt,
            stat,
            note
        from
            p_mete
        where 
            meno=#{value}
    </select>
    
    <select id="findAllByEmail" parameterType="String">
        select
            email
        from
            p_mete
        where 
            email=#{email}
    </select>
    
    
    <select id="findAllByNick" 
            resultMap="menteeMap" parameterType="Map">
        select
            meno,
            name,
            email,
            pwd,
            nick,
            phone,
            pstno,
            bas_addr,
            det_addr,
            phot,
            sell,
            bkname,
            bkno,
            rgdt,
            stat,
            note
        from
            p_mete
        where 
            nick=#{paramNick}
    </select>
    
    <select id="findAllByPhone" 
            resultMap="menteeMap" parameterType="Map">
        select
            meno,
            name,
            email,
            pwd,
            nick,
            phone,
            pstno,
            bas_addr,
            det_addr,
            phot,
            sell,
            bkname,
            bkno,
            rgdt,
            stat,
            note
        from
            p_mete
        where 
            phone=#{paramPhone}
    </select>
    
    <insert id="signup" parameterType="mentee"
            useGeneratedKeys="true" keyColumn="meno" keyProperty="no">
        insert into p_mete(name,email,pwd,nick,rgdt)
        values(#{name},#{email},#{pwd},#{nick},now())
    </insert> 
    
    <delete id="delete" parameterType="int">
        delete from p1_memb 
        where mno=#{value}
    </delete>
    
    
    
    <select id="findByEmailPassword" 
            resultMap="menteeMap" parameterType="map">
        select 
            meno,
            name,
            email,
            nick,
            phone,
            pstno,
            bas_addr,
            det_addr,
            phot,
            sell,
            bkname,
            bkno,
            rgdt,
            stat,
            note,
            mtstat
        from 
            p_mete mte
        where
            mte.email=#{email} and mte.pwd=#{pwd}
            <!-- mte.email=#{email} and mte.pwd=password(#{pwd}) -->
    </select> 
</mapper>
