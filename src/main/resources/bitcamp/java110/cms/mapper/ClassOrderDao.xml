<?xml version="1.0" encoding="UTF-8"?>
<!-- MemberDao 클래스가 사용할 SQL이 들어 있는 파일 -->
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="bitcamp.java110.cms.dao.ClassOrderDao">

    <resultMap type="classOrder" id="classOrderMap">
        <id 	column="ono" 		property="no"/>
        <result column="meno"   	property="meno"/>
        <result column="time"    	property="time"/>
        <result column="tot_pric"   property="tot_pric"/>
        <result column="payopt"  	property="payopt"/>
        <result column="paydt"  	property="paydt"/>
        <result column="ctno"  		property="ctno"/>
        
        <result column="mtname" property="mtname"/>
        <result column="titl" property="cls_titl"/>
        <result column="nick" property="mete_nick"/>
        <result column="nick2" property="mete2_nick"/>
        <result column="pric" property="cls_pric"/>
    </resultMap>
    
    <select id="orderlist" resultMap="classOrderMap" parameterType="map">
        select
        	meno,time,tot_pric,payopt,paydt,ctno
        from
        	p_cls_order
        	
    </select>
    
    
    <select id="findAllMaster" resultMap="classOrderMap">
        select
            mtag.mtname,
            cls.titl,
            mete.nick nick,
            mete2.nick nick2,
            cls.pric,
            paydt,
            corder.ono

        from
            p_cls_order as corder 
            inner join p_cls_ttab as ttab
            inner join p_cls as cls
            inner join p_mtag as mtag
            inner join p_mete as mete
            inner join p_mete as mete2
        on
            corder.ctno = ttab.ctno and
            ttab.cno = cls.cno and
            cls.mtno = mtag.mtno and
            corder.meno = mete.meno and
            mete2.meno = cls.mono
        order by
            ono asc

    </select>
    

    <insert id="orderinsert" parameterType="int"
    useGeneratedKeys="true" keyColumn="ono" keyProperty="no">
        insert 
        	into p_cls_order(meno,time,tot_pric,payopt,paydt,ctno)
        values
        	(#{meno},#{time},#{tot_pric},#{payopt},now(),#{ctno})
    </insert>
    
</mapper>









