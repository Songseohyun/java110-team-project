<?xml version="1.0" encoding="UTF-8"?>
<!-- MemberDao 클래스가 사용할 SQL이 들어 있는 파일 -->
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="bitcamp.java110.cms.dao.ClassOrderDao">

    <resultMap type="ClassOrder" id="ClassorderMap">
        <id 	column="ono" 		property="no"/>
        <result column="meno"   	property="meno"/>
        <result column="time"    	property="time"/>
        <result column="tot_pric"   property="totPric"/>
        <result column="payopt"  	property="payopt"/>
        <result column="paydt"  	property="paydt"/>
        <result column="ctno"  		property="ctno"/>
        
        <result column="ctitl"       property="classes.titl"/>
        <result column="mentornick"  property="mentornick"/>
    </resultMap>
    
    <select id="corderlist" resultMap="ClassorderMap" parameterType="map">
       
        SELECT
            co.ono,
            co.meno,
            co.time,
            co.tot_pric,
            co.payopt,
            co.paydt,
            co.ctno,
            c.titl as ctitl,
            me2.nick as mentornick
         FROM
            p_cls_order co JOIN p_mete me on co.meno = me.meno
            JOIN p_cls_ttab ct ON co.ctno = ct.ctno
            JOIN p_cls c ON ct.cno = c.cno
            JOIN p_meto mo ON c.mono =mo.mono
            JOIN p_mete me2 ON mo.mono = me2.meno 
        where
            me.meno=${meno}
   
        	
    </select>

    <insert id="orderinsert" parameterType="int"
    useGeneratedKeys="true" keyColumn="ono" keyProperty="no">
        insert 
        	into p_cls_order(meno,time,tot_pric,payopt,paydt,ctno)
        values
        	(#{meno},#{time},#{tot_pric},#{payopt},now(),#{ctno})
    </insert>
    
</mapper>









